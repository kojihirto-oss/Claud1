# Part 16：KB/RAG運用・更新プロトコル（知識更新・反映手順・汚染防止・参照規約）

## 0. このPartの位置づけ
- 目的：KB/RAGの更新と参照を安全に運用し、汚染と不整合を防ぐ
- 依存：Part00（真実順序）、Part10（Verify Gate）、Part12（Evidence）、Part14（変更管理）、Part15（運用ループ）
- 影響：docs/ 内の知識更新・参照規約、監査証跡の整合性

## 1. 目的（Purpose）
KB/RAGの更新を「発見 → 記録 → 修正 → 検証 → 監査」の運用ループで標準化し、  
参照規約と証跡を揃えてSSOTの整合性を維持する。

## 2. 適用範囲（Scope / Out of Scope）
### Scope（対象）
- docs/ におけるKB/RAGの更新手順と参照規約
- Verify結果の確認とEvidenceの整理

### Out of Scope（対象外）
- sources/ への更新
- 実装コードの詳細手順（別Part）

## 3. 前提（Assumptions）
1. 真実順序は Part00 に従う
2. Verifyの定義は Part10 に従う
3. Evidenceの形式と保存先は Part12 に従う
4. 変更管理は Part14 に従う
5. 運用ループは Part15 に従う

## 4. 用語（Glossary参照：Part02）
- **KB**: docs/ を中心に管理する知識ベース
- **RAG**: KBを参照する取得・統合の運用形態
- **汚染**: 真実順序や根拠を欠いた更新による不整合

## 5. ルール（MUST / MUST NOT / SHOULD）
### R-1601: 運用ループの順守【MUST】
KB/RAG更新は「発見 → 記録 → 修正 → 検証 → 監査」で実施し、順序を省略しない。

### R-1602: 参照根拠の明示【MUST】
変更理由は Part00 の真実順序に基づき、根拠を記録する。

### R-1603: 証跡はPASSのみ採用【MUST】
VerifyはPASS証跡のみを採用し、Evidenceに保存する。

### R-1604: 最小差分の更新【SHOULD】
無関係な整理を混在させず、最小差分で更新する。

## 6. 手順（実行可能な粒度、番号付き）
1. 発見：不整合や不足点を特定し、影響範囲を確認する。
2. 記録：発見内容、根拠、対象ファイルを記録する。
3. 修正：最小差分で更新し、変更理由を短く記録する。
4. 検証：Fast検証を実施し、PASS証跡を確認する。
5. 監査：変更概要・証跡一覧を残し、参照パスを整える。

## 7. 例外処理（失敗分岐・復旧・エスカレーション）
### 例外1: 検証が通らない
- 最大3ループで解決できない場合、HumanGateへエスカレーションする（Part09）。

### 例外2: 証跡が欠落
- 検証を再実行して補完し、理由を記録する。

## 8. 機械判定（Verify観点：判定条件・合否・ログ）
### V-1601: 運用ループの記録
**判定条件**:
1. 発見・修正・検証・監査の記録がある
2. PASS証跡のみ採用されている

**合否**:
- **PASS**: 1,2を満たす
- **FAIL**: 記録欠落、またはFAIL証跡の混在

**ログ**: evidence/verify_reports/

## 9. 監査観点（Evidenceに残すもの・参照パス）
### E-1601: 変更記録
**内容**: 発見内容、修正理由、参照根拠、変更概要  
**保存先**: evidence/ または decisions/（Part12/Part14に従う）

### E-1602: Verify証跡（PASSのみ）
**内容**: Fast検証のPASSログ  
**保存先**: evidence/verify_reports/

## 10. チェックリスト
- [ ] 発見・記録・修正・検証・監査の順序が揃っている
- [ ] PASS証跡のみを採用している
- [ ] 参照パスが更新されている

## 11. 未決事項（推測禁止）
- 参照根拠の記録粒度（最小単位の定義）

## 12. 参照（パス）
- docs/
- sources/
- evidence/
- decisions/
### docs/
- [Part00](./Part00.md) : SSOT憲法（真実順序）
- [Part15](./Part15.md) : 運用ループ（発見→記録→修正→検証→監査）
- [00_INDEX](./00_INDEX.md) : 全体索引
- [FACTS_LEDGER](./FACTS_LEDGER.md) : 事実台帳
