# MCP Authorization / Security Considerations Research

## URL
- https://modelcontextprotocol.io
- https://mcp-auth.dev
- https://modelcontextprotocol.info
- https://vulnerablemcp.info
- https://networkintelligence.ai
- https://towardsdatascience.com
- https://wso2.com

## 参照日
2026年1月16日金曜日

## 更新日
Not available in search results.

## 設計へ落とすべき要点（箇条書き）

### MCP Authorization
- MCPサーバーは、AIアプリケーションと外部システム間のセキュアな相互作用を保証するために、標準化された認証フローと堅牢なセキュリティ考慮事項を活用する。
- ユーザー固有のデータ、監査の必要性、ユーザー同意を必要とするAPIへのアクセス、厳格なアクセス制御を持つエンタープライズ環境での運用において強く推奨される。
- OAuth 2.1を基盤とし、OAuth 2.0 Authorization Server Metadata (RFC8414), OAuth 2.0 Dynamic Client Registration Protocol (RFC7591), OAuth 2.0 Protected Resource Metadata (RFC9728), Resource Indicators for OAuth 2.0 (RFC 8707) などの主要な標準を組み込んでいる。
- 認証フローは、通常、MCPサーバーが `401 Unauthorized` ステータスで応答し、クライアントを認証サーバー、サポートされるスコープ、その他の必要なリソース情報に誘導するProtected Resource Metadata (PRM) ドキュメントを提供する。
- MCPサーバーはOAuth 2.1リソースサーバーとして機能し、MCPクライアントはリソースオーナーの代理としてリクエストを行うOAuth 2.1クライアントとして機能する。

### MCP Security Considerations
- **コア原則**:
    - 「決して信用せず、常に検証する (Never Trust, Always Verify)」: すべてのMCP相互作用は、起源に関わらず認証・認可されなければならない。
    - ジャストインタイム（JIT）アクセス: 認証情報は、必要な場合にのみ発行されるべきで、時間制限があるべき。
    - 継続的な検証: すべてのリクエストに対して認可を再検証し、行動異常検出を実装する必要がある。
    - 明示的なサーバー検証: なりすましを防ぐため、MCPサーバーの身元は暗号的に検証されるべき。
    - 粒度の細かい権限制御: 各ツールと機能には、きめ細かいアクセス制御が不可欠である。
- **一般的な脆弱性と緩和策**:
    - プロンプトインジェクション攻撃: 悪意のある入力は、モデルが指示を無視したり、機密情報を漏洩したりするように操作できる。緩和策としては、ユーザー入力の検証、曖昧さのない区切り文字の使用、モデル出力のフィルタリング、モデルへの最小限のコンテキスト提供が含まれる。
    - 混同された代理人問題 (Confused Deputy Problem): 攻撃者はMCPプロキシサーバーを悪用して、ユーザーの同意なしに認証コードを取得できる。特に静的なクライアントID、動的なクライアント登録、同意クッキーが適切なクライアントごとの同意なしに組み合わされている場合に発生する。
    - セッションハイジャック: MCPサーバーはすべての受信リクエストを検証し、認証にセッションを使用せず、セキュアな非決定的なセッションIDを使用し、セッションIDをユーザー固有の情報にバインドする必要がある。
    - ローカルMCPサーバーの侵害: ローカルMCPサーバーへの不適切な制限は、任意のコード実行、データ漏洩、データ損失につながる可能性がある。
- **実装のベストプラクティス**:
    - セキュアな開発ライフサイクル: 要件、設計からコーディング、テスト、インシデント対応まで、すべてのフェーズにセキュリティを統合する。
    - ランタイム監視: システムコール、リソース使用量、ファイルアクセス、ネットワークアクティビティを監視して疑わしいパターンを検出する。
    - 基盤セキュリティ: すべてのユーザー入力を検証し、モデル出力をフィルタリング・サニタイズし、すべての相互作用をログに記録し、脆弱性がないかを定期的にテストする。
    - OAuth 2.1 with PKCE: MCP認証の実装は、機密クライアントとパブリッククライアントの両方でProof Key for Code Exchange (PKCE) を備えたOAuth 2.1を使用する必要がある。
    - HTTPS要件: すべての認証エンドポイントはHTTPSを介して提供される必要がある。
    - トークンストレージと検証: クライアントはトークンを安全に保存し、サーバーはアクセスが意図したオーディエンス向けに発行されたことを確認する必要がある。
    - リダイレクトURI検証: サーバーはオープンリダイレクトの脆弱性を防ぐためにリダイレクトURIを検証する必要がある。
    - STDIOトランスポートセキュリティ: STDIOトランスポートの場合、通信はローカルで行われるため安全と見なされ、ネットワークの脅威から保護される。セキュリティは基礎となるシステムのセキュリティに依存する。

## どのPartに追記するか（Part番号・見出し案）
Part09: Permission Tier (ReadOnly/PatchOnly/ExecLimited/HumanGateの権限設計)
見出し案: `5.4 Model Context Protocol (MCP) Authorization and Security Considerations`